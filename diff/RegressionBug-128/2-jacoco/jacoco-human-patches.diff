diff -r -U 3 ./RegMiner4APR-Regression-Bugs/BUGGY/src/main/java/org/springframework/hateoas/mvc/ControllerLinkBuilder.java ./RegMiner4APR-Regression-Bugs/BFC/src/main/java/org/springframework/hateoas/mvc/ControllerLinkBuilder.java
--- ./RegMiner4APR-Regression-Bugs/BUGGY/src/main/java/org/springframework/hateoas/mvc/ControllerLinkBuilder.java	2025-12-22 19:14:10.637741591 +1100
+++ ./RegMiner4APR-Regression-Bugs/BFC/src/main/java/org/springframework/hateoas/mvc/ControllerLinkBuilder.java	2025-12-22 19:10:44.425935834 +1100
@@ -32,7 +32,6 @@
 import org.springframework.hateoas.core.DummyInvocationUtils;
 import org.springframework.hateoas.core.LinkBuilderSupport;
 import org.springframework.hateoas.core.MappingDiscoverer;
-import org.springframework.http.server.ServletServerHttpRequest;
 import org.springframework.util.Assert;
 import org.springframework.util.ConcurrentReferenceHashMap;
 import org.springframework.web.bind.annotation.RequestMapping;
@@ -264,7 +263,7 @@
 	static UriComponentsBuilder getBuilder() {
 
 		HttpServletRequest request = getCurrentRequest();
-		UriComponentsBuilder builder = UriComponentsBuilder.fromHttpRequest(new ServletServerHttpRequest(request));
+		UriComponentsBuilder builder = ServletUriComponentsBuilder.fromServletMapping(request);
 
 		// special case handling for X-Forwarded-Ssl:
 		// apply it, but only if X-Forwarded-Proto is unset.
